% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/wrf.R
\name{wrf}
\alias{wrf}
\title{Weighted Random Forest (WRF)}
\usage{
wrf(
  x,
  y,
  class.weights = NULL,
  ntree = 100,
  mtry = NULL,
  nodesize = 1,
  sampsize = NULL
)
}
\arguments{
\item{x}{A data frame or matrix of predictor variables.}

\item{y}{A factor vector of class labels.}

\item{class.weights}{A named numeric vector specifying weights for each class. If NULL, defaults to inverse frequency weights.}

\item{ntree}{Integer, the number of trees to grow in the forest.}

\item{mtry}{Integer, number of variables randomly sampled at each split. Defaults to \code{floor(sqrt(ncol(x)))}.}

\item{nodesize}{Minimum size of terminal nodes.}

\item{sampsize}{Number or vector of sample sizes to draw for each tree. Defaults to \code{floor(0.632 * nrow(x))}.}
}
\value{
An object of class \code{"wrf"} containing:
\item{class.weights}{The class weights used.}
\item{oob.error}{The OOB error estimate.}
\item{oob.votes}{A matrix of accumulated OOB votes for each sample.}
}
\description{
Train a Weighted Random Forest classifier on a (possibly) imbalanced dataset. Trains a Weighted Random Forest (WRF) model on a dataset. This WRF implements cost-sensitive learning through class weighting to handle imbalanced classification problems.
}
\details{
This function implements a Weighted Random Forest algorithm. Class weights are integrated into:
\itemize{
\item The Gini splitting criterion, making it cost-sensitive.
\item The leaf node predictions, which use a weighted majority vote.
}
Final predictions are obtained by aggregating weighted probabilities across all trees.

The OOB (out-of-bag) error is computed during training by predicting samples not used in constructing each tree.
}
\examples{
\dontrun{
data(iris)
setosa_vs_others <- iris$Species
levels(setosa_vs_others) <- c("minority", "majority", "majority")

model <- wrf(
  x = iris[, -5],
  y = setosa_vs_others,
  ntree = 50,
  class.weights = c("minority" = 5, "majority" = 1)
)

print(model$oob.error)
}
}
